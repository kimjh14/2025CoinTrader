# 가상화폐 LSTM 모델 훈련데이터 수집 시스템

이 프로젝트는 가상화폐 자동 매매를 위한 LSTM 모델의 훈련데이터를 수집하고 분석하는 시스템입니다.

# 코드 사용방법법

1. 인터랙티브 모드 (인자 없이 실행):
  python run_data_collection.py
  프로그램이 차례대로 물어봅니다:
  - 수집할 코인 (예: BTC,ETH,SOL)
  - 시작 날짜 (예: 2025-07-20)
  - 종료 날짜 (예: 2025-07-23)

  2. 명령줄 인자로 직접 지정:
  python run_data_collection.py -c ADA -s 2025-07-20 -e 2025-07-23

  3. 부분적으로만 지정 (나머지는 인터랙티브):
  python run_data_collection.py -c BTC,ETH
  이 경우 날짜만 물어봅니다.

  4. 종료 날짜 생략 (오늘까지):
  python run_data_collection.py -c SOL -s 2025-07-01

  주요 개선사항:
  - 특정 날짜 범위를 직접 지정 가능
  - 인터랙티브 모드 지원 (인자 없이 실행시)
  - 날짜 유효성 검증 (시작일이 종료일보다 늦으면 자동 교환)
  - 기본값 제공 (코인: BTC,ETH,SOL / 시작일: 30일 전 / 종료일: 오늘)



## 🎯 목적

- 업비트 API를 통한 비트코인, 도지코인, 솔라나, 엑스알피의 과거 데이터 수집
- 기술적 지표 계산 (MACD, RSI, 볼린저 밴드, 이동평균선, ATR 등)
- 멀티 타임프레임 데이터 융합
- 데이터 품질 분석 및 시각화
- LSTM 모델 훈련을 위한 레이블 생성

## 📁 파일 구조

```
MakeTradingData/
├── data_collector.py          # 데이터 수집 및 기술적 지표 계산
├── data_analyzer.py           # 데이터 분석 및 시각화
├── run_data_collection.py     # 메인 실행 스크립트
├── requirements.txt           # 필요한 Python 패키지
├── README.md                  # 프로젝트 설명서
└── data/                      # 수집된 데이터 저장소
    ├── raw/                   # 원시 데이터
    └── processed/             # 가공된 데이터 및 분석 결과
```

## 🚀 설치 및 실행

### 1. 필요한 패키지 설치

```bash
pip install -r requirements.txt
```

### 2. API 키 설정 확인

`/Users/hi/2025Works/AI_Trader/config.py` 파일에 업비트 API 키가 설정되어 있는지 확인하세요.

### 3. 데이터 수집 및 분석 실행

```bash
python run_data_collection.py
```

## 📊 수집되는 데이터

### 대상 코인
- **BTC** (비트코인)
- **DOGE** (도지코인)  
- **SOL** (솔라나)
- **XRP** (엑스알피)

### 타임프레임
- 1분봉, 3분봉, 5분봉, 15분봉, 1시간봉, 4시간봉, 일봉

### 기술적 지표
- **MACD**: MACD, Signal, Histogram
- **RSI**: 상대강도지수
- **볼린저 밴드**: 상단, 중간, 하단, 밴드폭
- **이동평균선**: MA5, MA10, MA20, MA60
- **ATR**: Average True Range
- **거래량 지표**: 거래량 이동평균, 거래량 비율
- **변동성 지표**: 가격 변동성, 변동성 비율

### 미세 특징 (1분봉)
- 변동성 (표준편차)
- 추세 강도
- 고저가 범위
- 상승 틱 비율
- 거래량 집중도
- 가격 모멘텀
- 거래량 모멘텀

## 🎯 예측 목표

3-class 분류 문제로 설정:
- **0 (상승)**: 5분 후 가격이 0.2% 이상 상승
- **1 (하락)**: 5분 후 가격이 0.2% 이상 하락  
- **2 (횡보)**: 5분 후 가격 변화가 0.2% 미만

## 📈 생성되는 분석 결과

### 데이터 파일
- `{코인명}_training_dataset.csv`: LSTM 훈련용 통합 데이터셋
- `data_quality_analysis.json`: 데이터 품질 분석 리포트

### 시각화 파일
- `{코인명}_price_chart.html`: 인터랙티브 가격 차트
- `{코인명}_correlation_heatmap.png`: 특성 상관관계 히트맵
- `{코인명}_label_distribution.png`: 레이블 분포
- `{코인명}_technical_indicators.png`: 기술적 지표
- `coin_volatility_comparison.png`: 코인 변동성 비교

## 🔧 주요 기능

### 1. 데이터 수집 (`data_collector.py`)
- 업비트 API를 통한 캔들 데이터 수집
- 기술적 지표 자동 계산
- 멀티 타임프레임 데이터 융합
- 미세 특징 추출
- 예측 레이블 생성

### 2. 데이터 분석 (`data_analyzer.py`)
- 가격 패턴 분석
- 기술적 지표 분석
- 상관관계 분석
- 레이블 분포 분석
- 코인 간 비교 분석
- 종합 분석 리포트 생성

### 3. 시각화
- Plotly를 이용한 인터랙티브 차트
- Matplotlib/Seaborn을 이용한 정적 차트
- 상관관계 히트맵
- 기술적 지표 시각화

## 📋 데이터 품질 관리

- **이상치 처리**: 급격한 가격 변동 필터링
- **결측값 처리**: 기술적 지표 계산 시 결측값 자동 처리
- **정규화**: 각 특성별 적절한 정규화 방법 적용
- **데이터 검증**: 수집된 데이터의 품질 자동 검증

## 🎯 LSTM 모델 적용 방안

수집된 데이터는 다음과 같이 LSTM 모델에 활용할 수 있습니다:

### 입력 특성
- OHLCV (시가, 고가, 저가, 종가, 거래량)
- 기술적 지표 (MACD, RSI, 볼린저 밴드 등)
- 멀티 타임프레임 특성
- 미세 특징 (변동성, 추세 강도 등)

### 모델 구조 제안
```python
# 멀티 타임프레임 LSTM 모델
model = Sequential([
    Bidirectional(LSTM(128, return_sequences=True)),
    MultiHeadAttention(num_heads=8, key_dim=64),
    LSTM(64, return_sequences=True),
    LSTM(32),
    Dense(16, activation='relu'),
    Dense(3, activation='softmax')  # 3-class 분류
])
```

## ⚠️ 주의사항

1. **API 호출 제한**: 업비트 API 호출 제한을 고려하여 적절한 대기 시간 설정
2. **데이터 저장**: 대용량 데이터 수집 시 충분한 저장 공간 확보
3. **실시간성**: 실시간 거래를 위해서는 추가적인 실시간 데이터 수집 시스템 필요
4. **백테스팅**: 실제 거래 전 반드시 백테스팅을 통한 검증 필요

## 🔄 다음 단계

1. **모델 개발**: 수집된 데이터를 이용한 LSTM 모델 개발
2. **하이퍼파라미터 튜닝**: 모델 성능 최적화
3. **앙상블 모델**: 여러 모델의 조합을 통한 성능 향상
4. **실시간 시스템**: 실시간 예측 및 거래 시스템 구축
5. **위험 관리**: 포지션 크기 조정 및 손실 제한 시스템

## 📞 문의

프로젝트 관련 문의사항이 있으시면 언제든지 연락주세요. 