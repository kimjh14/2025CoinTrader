D:\2025CoinTrader\Model_maker\crypto_prediction_model.py를 수정해서 새 파일로 다음 사항 수정코드를 저장

BI-LSTM모델만 사용
 
모든 데이터는 정규화를 통해 스케일을 맞춘다. 

1분봉만 사용해서서 훈련을 한다. 

예측시간대의 직전 10개 시간(1분)의 데이터를 사용한다.

MACD의 macd선, 시그널선과 오실레이터크기만 훈련데이터로 사용한다. 

목표는 1분뒤에 종가가 오를지 내릴지만 그대로일지 예측한다. 

판단시 종가의 변동은 0.05%로 한다

## 개선된 모델 특징

### 1. 모델 구조
- **BI-LSTM 모델만 사용**: XGBoost 제거하고 Bi-LSTM에 집중
- **Attention Mechanism**: 시퀀스 내 중요 시점에 가중치 부여
- **Dropout**: 과적합 방지 (0.2)
- **AdamW Optimizer**: 가중치 감쇠 적용

### 2. 데이터 처리
- **1분봉만 사용**: 3분봉, 5분봉 제거하여 단순화
- **직전 10개 시간 시퀀스**: 예측 시점의 직전 10분 데이터 사용
- **MACD 지표만 사용**: 
  - MACD 선 (12, 26 EMA 차이)
  - 시그널 선 (MACD의 9 EMA)
  - 오실레이터 크기 (MACD - 시그널)
- **StandardScaler 정규화**: 모든 특징을 표준화

### 3. 레이블 생성
- **3-클래스 분류**:
  - 클래스 0 (하락): 1분 뒤 수익률 < -0.05%
  - 클래스 1 (보류): -0.05% ≤ 1분 뒤 수익률 ≤ 0.05%
  - 클래스 2 (상승): 1분 뒤 수익률 > 0.05%

### 4. 성능 최적화
- **GPU/CPU 자동 감지**: CUDA 사용 가능시 GPU, 불가능시 CPU
- **배치 크기 최적화**: GPU 128, CPU 64
- **Early Stopping**: 검증 정확도 개선 없으면 10 에포크 후 중단
- **Cosine Annealing Scheduler**: 학습률 자동 조정

## 실행 방법

### 1. 가상환경 활성화
```bash
cd D:\2025CoinTrader
venv\Scripts\activate
```

### 2. 필요한 패키지 설치
```bash
pip install torch torchvision torchaudio
pip install pandas numpy scikit-learn matplotlib seaborn tqdm
```

### 3. 모델 실행
```bash
cd Model_maker
python improved_crypto_prediction_model.py
```

## 실제 실행 결과

### 1. 모델 파일
- `improved_bilstm_crypto_model.pth`: 훈련된 모델 (6.5MB)
- `best_improved_bilstm_model.pth`: 최고 성능 모델 (6.5MB)

### 2. 시각화 파일
- `improved_model_results.png`: 백테스팅 결과 (304KB)
- `improved_training_history.png`: 훈련 과정 (211KB)

### 3. 성능 지표 (실제 결과)
- **정확도**: 39.98%
- **F1 점수**: [0.0, 0.0, 0.571] (클래스별)
- **총 수익률**: 8.11% ✅
- **샤프 지수**: 0.6897 ✅
- **최대 손실폭**: -46.17%
- **승률**: 0.00%
- **거래 횟수**: 1

### 4. 클래스 분포
- **클래스 0 (하락)**: 168,180개 (34.4%)
- **클래스 1 (보류)**: 154,388개 (31.6%)
- **클래스 2 (상승)**: 165,743개 (34.0%)

### 5. 훈련 정보
- **훈련 데이터**: 697,602개 샘플
- **검증 데이터**: 123,510개 샘플
- **훈련 에포크**: 18 (Early stopping)
- **배치 크기**: 128 (GPU 최적화)
- **GPU 사용**: NVIDIA GeForce RTX 4070 SUPER

## 주요 개선사항

1. **단순화**: 다중 시간대 제거로 모델 복잡도 감소
2. **집중**: MACD 지표만 사용하여 노이즈 감소
3. **효율성**: 1분봉만 사용하여 처리 속도 향상
4. **안정성**: Early stopping과 정규화로 과적합 방지
5. **확장성**: GPU/CPU 자동 감지로 다양한 환경 지원

